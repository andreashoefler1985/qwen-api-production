[Definition]
# Fail2ban filter f√ºr API Authentication Failures

# Auth endpoint failures
failregex = ^<HOST> .* "(POST|PUT|PATCH) \/api\/(auth|login|token)" (401|403) .*$
            ^<HOST> .* "(POST|PUT|PATCH) \/auth\/" (401|403) .*$
            ^<HOST> .* ".*" (401|403) .* "Invalid API key".*$
            ^<HOST> .* ".*" (429) .* "Daily limit exceeded".*$

# Ignore successful auth
ignoreregex = ^<HOST> .* "(POST|PUT|PATCH) \/api\/(auth|login|token)" 200 .*$
              ^<HOST> .* "(GET|POST) \/health" .*$

[Init]
datepattern = %%d/%%b/%%Y:%%H:%%M:%%S %%z
